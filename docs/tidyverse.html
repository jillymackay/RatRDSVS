<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 The Tidyverse | R @ R(D)SVS</title>
  <meta name="description" content="This book will help you get started in R. It’s designed for students (and staff) at R(D)SVS, and is free to use and adapt." />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 The Tidyverse | R @ R(D)SVS" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book will help you get started in R. It’s designed for students (and staff) at R(D)SVS, and is free to use and adapt." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 The Tidyverse | R @ R(D)SVS" />
  
  <meta name="twitter:description" content="This book will help you get started in R. It’s designed for students (and staff) at R(D)SVS, and is free to use and adapt." />
  

<meta name="author" content="Jill R D MacKay" />


<meta name="date" content="2020-08-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dataprocessing.html"/>
<link rel="next" href="trouble.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="css\styles.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>R @ R(D)SVS</a></li>
<li class="chapter" data-level="" data-path="about.html"><a href="about.html"><i class="fa fa-check"></i>About this book</a><ul>
<li class="chapter" data-level="0.1" data-path="about.html"><a href="about.html#howuse"><i class="fa fa-check"></i><b>0.1</b> How to use this book</a><ul>
<li class="chapter" data-level="0.1.1" data-path="about.html"><a href="about.html#useinclass"><i class="fa fa-check"></i><b>0.1.1</b> As a student in class</a></li>
<li class="chapter" data-level="0.1.2" data-path="about.html"><a href="about.html#useindependent"><i class="fa fa-check"></i><b>0.1.2</b> As a student learning independently</a></li>
<li class="chapter" data-level="0.1.3" data-path="about.html"><a href="about.html#useteach"><i class="fa fa-check"></i><b>0.1.3</b> As a teacher</a></li>
</ul></li>
<li class="chapter" data-level="0.2" data-path="about.html"><a href="about.html#usetips"><i class="fa fa-check"></i><b>0.2</b> Tips for using an online textbook</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="install.html"><a href="install.html"><i class="fa fa-check"></i><b>1</b> Installing R</a><ul>
<li class="chapter" data-level="1.1" data-path="install.html"><a href="install.html#install_r"><i class="fa fa-check"></i><b>1.1</b> Install R</a></li>
<li class="chapter" data-level="1.2" data-path="install.html"><a href="install.html#install_rs"><i class="fa fa-check"></i><b>1.2</b> Install R Studio</a><ul>
<li class="chapter" data-level="1.2.1" data-path="install.html"><a href="install.html#navigate_rs"><i class="fa fa-check"></i><b>1.2.1</b> Quick R Studio Navigation Guide</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="install.html"><a href="install.html#install_rsc"><i class="fa fa-check"></i><b>1.3</b> Using the Cloud</a></li>
<li class="chapter" data-level="1.4" data-path="install.html"><a href="install.html#install_vids"><i class="fa fa-check"></i><b>1.4</b> Install R and R Studio - Video Instruction</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="start.html"><a href="start.html"><i class="fa fa-check"></i><b>2</b> Getting Started</a><ul>
<li class="chapter" data-level="2.1" data-path="start.html"><a href="start.html#thesecret"><i class="fa fa-check"></i><b>2.1</b> The Big Secret</a><ul>
<li class="chapter" data-level="2.1.1" data-path="start.html"><a href="start.html#ex_tidytuesday"><i class="fa fa-check"></i><b>2.1.1</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="start.html"><a href="start.html#projects"><i class="fa fa-check"></i><b>2.2</b> Projects</a></li>
<li class="chapter" data-level="2.3" data-path="start.html"><a href="start.html#environment"><i class="fa fa-check"></i><b>2.3</b> Environment</a><ul>
<li class="chapter" data-level="2.3.1" data-path="start.html"><a href="start.html#ex_env"><i class="fa fa-check"></i><b>2.3.1</b> Exercise - Environment</a></li>
<li class="chapter" data-level="2.3.2" data-path="start.html"><a href="start.html#ex_func"><i class="fa fa-check"></i><b>2.3.2</b> Exercise - Functions</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="start.html"><a href="start.html#packages"><i class="fa fa-check"></i><b>2.4</b> Packages</a><ul>
<li class="chapter" data-level="2.4.1" data-path="start.html"><a href="start.html#ex_packages"><i class="fa fa-check"></i><b>2.4.1</b> Exercise - Install and Load a Package</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="start.html"><a href="start.html#scripts_rmd"><i class="fa fa-check"></i><b>2.5</b> R Markdown vs R Scripts</a><ul>
<li class="chapter" data-level="2.5.1" data-path="start.html"><a href="start.html#r-scripts"><i class="fa fa-check"></i><b>2.5.1</b> R Scripts</a></li>
<li class="chapter" data-level="2.5.2" data-path="start.html"><a href="start.html#r-markdown"><i class="fa fa-check"></i><b>2.5.2</b> R Markdown</a></li>
<li class="chapter" data-level="2.5.3" data-path="start.html"><a href="start.html#video_rmd"><i class="fa fa-check"></i><b>2.5.3</b> A video on R Markdown</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="start.html"><a href="start.html#video_env"><i class="fa fa-check"></i><b>2.6</b> Video Introductions</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data.html"><a href="data.html"><i class="fa fa-check"></i><b>3</b> Data</a><ul>
<li class="chapter" data-level="3.1" data-path="data.html"><a href="data.html#packages-for-this-chapter"><i class="fa fa-check"></i><b>3.1</b> Packages for this chapter</a></li>
<li class="chapter" data-level="3.2" data-path="data.html"><a href="data.html#data_builtin"><i class="fa fa-check"></i><b>3.2</b> Built In Data</a></li>
<li class="chapter" data-level="3.3" data-path="data.html"><a href="data.html#ex_inbuiltdata"><i class="fa fa-check"></i><b>3.3</b> Exercise</a></li>
<li class="chapter" data-level="3.4" data-path="data.html"><a href="data.html#created_data"><i class="fa fa-check"></i><b>3.4</b> Data you create</a></li>
<li class="chapter" data-level="3.5" data-path="data.html"><a href="data.html#ex_createdata"><i class="fa fa-check"></i><b>3.5</b> Exercise - Creating data</a></li>
<li class="chapter" data-level="3.6" data-path="data.html"><a href="data.html#data_load"><i class="fa fa-check"></i><b>3.6</b> Loading data from your hard drive</a></li>
<li class="chapter" data-level="3.7" data-path="data.html"><a href="data.html#ex_data_load"><i class="fa fa-check"></i><b>3.7</b> Loading data</a><ul>
<li class="chapter" data-level="3.7.1" data-path="data.html"><a href="data.html#loading-from-a-csv"><i class="fa fa-check"></i><b>3.7.1</b> Loading from a CSV</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="data.html"><a href="data.html#ex_loadcsv"><i class="fa fa-check"></i><b>3.8</b> Exercise</a><ul>
<li class="chapter" data-level="3.8.1" data-path="data.html"><a href="data.html#loading-from-an-excel-file"><i class="fa fa-check"></i><b>3.8.1</b> Loading from an Excel file</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="data.html"><a href="data.html#ex_loadexcel"><i class="fa fa-check"></i><b>3.9</b> Exercise</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="charts.html"><a href="charts.html"><i class="fa fa-check"></i><b>4</b> Charts</a><ul>
<li class="chapter" data-level="4.1" data-path="charts.html"><a href="charts.html#datavis"><i class="fa fa-check"></i><b>4.1</b> Data Visualisation</a><ul>
<li class="chapter" data-level="4.1.1" data-path="charts.html"><a href="charts.html#vis_bad"><i class="fa fa-check"></i><b>4.1.1</b> When charts go bad</a></li>
<li class="chapter" data-level="4.1.2" data-path="charts.html"><a href="charts.html#vis_anatomy"><i class="fa fa-check"></i><b>4.1.2</b> Chart anatomy</a></li>
<li class="chapter" data-level="4.1.3" data-path="charts.html"><a href="charts.html#vis_bar"><i class="fa fa-check"></i><b>4.1.3</b> Bar charts</a></li>
<li class="chapter" data-level="4.1.4" data-path="charts.html"><a href="charts.html#vis_hist"><i class="fa fa-check"></i><b>4.1.4</b> Histograms</a></li>
<li class="chapter" data-level="4.1.5" data-path="charts.html"><a href="charts.html#vis_scatter"><i class="fa fa-check"></i><b>4.1.5</b> Scatterplots</a></li>
<li class="chapter" data-level="4.1.6" data-path="charts.html"><a href="charts.html#vis_box"><i class="fa fa-check"></i><b>4.1.6</b> Boxplots</a></li>
<li class="chapter" data-level="4.1.7" data-path="charts.html"><a href="charts.html#vis_infographic"><i class="fa fa-check"></i><b>4.1.7</b> Infographics</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot.html"><a href="ggplot.html"><i class="fa fa-check"></i><b>5</b> ggplot2</a><ul>
<li class="chapter" data-level="5.1" data-path="ggplot.html"><a href="ggplot.html#why-ggplot"><i class="fa fa-check"></i><b>5.1</b> Why ggplot?</a></li>
<li class="chapter" data-level="5.2" data-path="ggplot.html"><a href="ggplot.html#gg_build"><i class="fa fa-check"></i><b>5.2</b> Building a ggplot object (a scatterplot)</a><ul>
<li class="chapter" data-level="5.2.1" data-path="ggplot.html"><a href="ggplot.html#gg_axis"><i class="fa fa-check"></i><b>5.2.1</b> Changing an axis in ggplot2</a></li>
<li class="chapter" data-level="5.2.2" data-path="ggplot.html"><a href="ggplot.html#gg_theme"><i class="fa fa-check"></i><b>5.2.2</b> Changing themes</a></li>
<li class="chapter" data-level="5.2.3" data-path="ggplot.html"><a href="ggplot.html#gg_labs"><i class="fa fa-check"></i><b>5.2.3</b> Changing labels and titles</a></li>
<li class="chapter" data-level="5.2.4" data-path="ggplot.html"><a href="ggplot.html#gg_smooth"><i class="fa fa-check"></i><b>5.2.4</b> Adding regression lines to ggplot</a></li>
<li class="chapter" data-level="5.2.5" data-path="ggplot.html"><a href="ggplot.html#gg_groups"><i class="fa fa-check"></i><b>5.2.5</b> Adding groups to ggplot</a></li>
<li class="chapter" data-level="5.2.6" data-path="ggplot.html"><a href="ggplot.html#gg_legend"><i class="fa fa-check"></i><b>5.2.6</b> Changing legends</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="ggplot.html"><a href="ggplot.html#gg_boxplot"><i class="fa fa-check"></i><b>5.3</b> Building a boxplot</a></li>
<li class="chapter" data-level="5.4" data-path="ggplot.html"><a href="ggplot.html#gg_facets"><i class="fa fa-check"></i><b>5.4</b> Facets</a></li>
<li class="chapter" data-level="5.5" data-path="ggplot.html"><a href="ggplot.html#gg_bars"><i class="fa fa-check"></i><b>5.5</b> Bar charts</a></li>
<li class="chapter" data-level="5.6" data-path="ggplot.html"><a href="ggplot.html#ex_ggplot"><i class="fa fa-check"></i><b>5.6</b> Exercise</a></li>
<li class="chapter" data-level="5.7" data-path="ggplot.html"><a href="ggplot.html#gg_vids"><i class="fa fa-check"></i><b>5.7</b> Videos</a></li>
<li class="chapter" data-level="5.8" data-path="ggplot.html"><a href="ggplot.html#gg_resources"><i class="fa fa-check"></i><b>5.8</b> Useful resources</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="dataprocessing.html"><a href="dataprocessing.html"><i class="fa fa-check"></i><b>6</b> Data Processing</a><ul>
<li class="chapter" data-level="6.1" data-path="dataprocessing.html"><a href="dataprocessing.html#workflows"><i class="fa fa-check"></i><b>6.1</b> Workflows</a><ul>
<li class="chapter" data-level="6.1.1" data-path="dataprocessing.html"><a href="dataprocessing.html#an-example-of-sharing-code"><i class="fa fa-check"></i><b>6.1.1</b> An example of sharing code</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="dataprocessing.html"><a href="dataprocessing.html#openrmd"><i class="fa fa-check"></i><b>6.2</b> Opening R Markdown Docs</a></li>
<li class="chapter" data-level="6.3" data-path="dataprocessing.html"><a href="dataprocessing.html#codermd"><i class="fa fa-check"></i><b>6.3</b> Running Code</a></li>
<li class="chapter" data-level="6.4" data-path="dataprocessing.html"><a href="dataprocessing.html#editrmd"><i class="fa fa-check"></i><b>6.4</b> Editing R Markdown Docs</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>7</b> The Tidyverse</a><ul>
<li class="chapter" data-level="7.1" data-path="tidyverse.html"><a href="tidyverse.html#tidy_opinions"><i class="fa fa-check"></i><b>7.1</b> Opinionated Packages</a></li>
<li class="chapter" data-level="7.2" data-path="tidyverse.html"><a href="tidyverse.html#data-for-this-chapter"><i class="fa fa-check"></i><b>7.2</b> Data for this chapter</a></li>
<li class="chapter" data-level="7.3" data-path="tidyverse.html"><a href="tidyverse.html#mutate"><i class="fa fa-check"></i><b>7.3</b> Mutating data</a><ul>
<li class="chapter" data-level="7.3.1" data-path="tidyverse.html"><a href="tidyverse.html#mutate-to-change-a-variable-type."><i class="fa fa-check"></i><b>7.3.1</b> Mutate to change a variable type.</a></li>
<li class="chapter" data-level="7.3.2" data-path="tidyverse.html"><a href="tidyverse.html#mutate-to-change-the-contents-of-data"><i class="fa fa-check"></i><b>7.3.2</b> Mutate to change the contents of data</a></li>
<li class="chapter" data-level="7.3.3" data-path="tidyverse.html"><a href="tidyverse.html#mutate-to-change-multiple-variables"><i class="fa fa-check"></i><b>7.3.3</b> Mutate to change multiple variables</a></li>
<li class="chapter" data-level="7.3.4" data-path="tidyverse.html"><a href="tidyverse.html#tidy_summ"><i class="fa fa-check"></i><b>7.3.4</b> Summarise as a unique form of mutate</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="tidyverse.html"><a href="tidyverse.html#pivoting_data"><i class="fa fa-check"></i><b>7.4</b> Wide and tall data</a><ul>
<li class="chapter" data-level="7.4.1" data-path="tidyverse.html"><a href="tidyverse.html#processing-data"><i class="fa fa-check"></i><b>7.4.1</b> Processing data</a></li>
<li class="chapter" data-level="7.4.2" data-path="tidyverse.html"><a href="tidyverse.html#pivot_longer"><i class="fa fa-check"></i><b>7.4.2</b> pivot_longer</a></li>
</ul></li>
<li class="chapter" data-level="7.5" data-path="tidyverse.html"><a href="tidyverse.html#pivot_wider"><i class="fa fa-check"></i><b>7.5</b> pivot_wider</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="trouble.html"><a href="trouble.html"><i class="fa fa-check"></i><b>8</b> Troubleshooting</a><ul>
<li class="chapter" data-level="8.1" data-path="trouble.html"><a href="trouble.html#working-independently"><i class="fa fa-check"></i><b>8.1</b> Working independently</a></li>
<li class="chapter" data-level="8.2" data-path="trouble.html"><a href="trouble.html#trouble_warnings"><i class="fa fa-check"></i><b>8.2</b> Common warnings</a></li>
<li class="chapter" data-level="8.3" data-path="trouble.html"><a href="trouble.html#trouble_errors"><i class="fa fa-check"></i><b>8.3</b> Common errors</a><ul>
<li class="chapter" data-level="8.3.1" data-path="trouble.html"><a href="trouble.html#object-not-found."><i class="fa fa-check"></i><b>8.3.1</b> Object not found.</a></li>
<li class="chapter" data-level="8.3.2" data-path="trouble.html"><a href="trouble.html#function-not-found"><i class="fa fa-check"></i><b>8.3.2</b> Function not found</a></li>
<li class="chapter" data-level="8.3.3" data-path="trouble.html"><a href="trouble.html#unexpected-symbols"><i class="fa fa-check"></i><b>8.3.3</b> Unexpected symbols</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="trouble.html"><a href="trouble.html#quick-warnings-and-errors"><i class="fa fa-check"></i><b>8.4</b> Quick warnings and errors</a></li>
<li class="chapter" data-level="8.5" data-path="trouble.html"><a href="trouble.html#searching-for-help"><i class="fa fa-check"></i><b>8.5</b> Searching for help</a><ul>
<li class="chapter" data-level="8.5.1" data-path="trouble.html"><a href="trouble.html#trouble_help"><i class="fa fa-check"></i><b>8.5.1</b> Tips for asking for help</a></li>
</ul></li>
<li class="chapter" data-level="8.6" data-path="trouble.html"><a href="trouble.html#trouble_reprex"><i class="fa fa-check"></i><b>8.6</b> Reproducible Examples (reprex)</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="statsbasic.html"><a href="statsbasic.html"><i class="fa fa-check"></i><b>9</b> Basic Statistics</a><ul>
<li class="chapter" data-level="9.1" data-path="statsbasic.html"><a href="statsbasic.html#descstats"><i class="fa fa-check"></i><b>9.1</b> Descriptive stats</a><ul>
<li class="chapter" data-level="9.1.1" data-path="statsbasic.html"><a href="statsbasic.html#mathematical-notation"><i class="fa fa-check"></i><b>9.1.1</b> Mathematical notation</a></li>
<li class="chapter" data-level="9.1.2" data-path="statsbasic.html"><a href="statsbasic.html#stats_mean"><i class="fa fa-check"></i><b>9.1.2</b> The mean</a></li>
<li class="chapter" data-level="9.1.3" data-path="statsbasic.html"><a href="statsbasic.html#the-mean-as-a-model"><i class="fa fa-check"></i><b>9.1.3</b> The mean as a model</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="statsbasic.html"><a href="statsbasic.html#stats_median"><i class="fa fa-check"></i><b>9.2</b> Median</a></li>
<li class="chapter" data-level="9.3" data-path="statsbasic.html"><a href="statsbasic.html#stats_mode"><i class="fa fa-check"></i><b>9.3</b> Mode</a></li>
<li class="chapter" data-level="9.4" data-path="statsbasic.html"><a href="statsbasic.html#stats_which"><i class="fa fa-check"></i><b>9.4</b> Which model?</a></li>
<li class="chapter" data-level="9.5" data-path="statsbasic.html"><a href="statsbasic.html#stats_variation"><i class="fa fa-check"></i><b>9.5</b> Measures of variation</a><ul>
<li class="chapter" data-level="9.5.1" data-path="statsbasic.html"><a href="statsbasic.html#stats_variance"><i class="fa fa-check"></i><b>9.5.1</b> Variance</a></li>
<li class="chapter" data-level="9.5.2" data-path="statsbasic.html"><a href="statsbasic.html#stats_sd"><i class="fa fa-check"></i><b>9.5.2</b> Standard Deviation</a></li>
<li class="chapter" data-level="9.5.3" data-path="statsbasic.html"><a href="statsbasic.html#stats_se"><i class="fa fa-check"></i><b>9.5.3</b> Standard Error</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="statsbasic.html"><a href="statsbasic.html#calculating-descriptive-stats"><i class="fa fa-check"></i><b>9.6</b> Calculating descriptive stats</a></li>
<li class="chapter" data-level="9.7" data-path="statsbasic.html"><a href="statsbasic.html#reporting-on-heifer-weight"><i class="fa fa-check"></i><b>9.7</b> Reporting on heifer weight</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="statsfreq.html"><a href="statsfreq.html"><i class="fa fa-check"></i><b>10</b> Predicting more things</a><ul>
<li class="chapter" data-level="10.1" data-path="statsfreq.html"><a href="statsfreq.html#linear-models"><i class="fa fa-check"></i><b>10.1</b> Linear models</a></li>
<li class="chapter" data-level="10.2" data-path="statsfreq.html"><a href="statsfreq.html#exercise9_1"><i class="fa fa-check"></i><b>10.2</b> ANOVA exercise</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="whatnext.html"><a href="whatnext.html"><i class="fa fa-check"></i><b>11</b> What next</a><ul>
<li class="chapter" data-level="11.1" data-path="whatnext.html"><a href="whatnext.html#github"><i class="fa fa-check"></i><b>11.1</b> github</a></li>
<li class="chapter" data-level="11.2" data-path="whatnext.html"><a href="whatnext.html#repeatablecode"><i class="fa fa-check"></i><b>11.2</b> repeatabe code</a></li>
<li class="chapter" data-level="11.3" data-path="whatnext.html"><a href="whatnext.html#adv_stats"><i class="fa fa-check"></i><b>11.3</b> Complicated stats</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="whyr.html"><a href="whyr.html"><i class="fa fa-check"></i><b>12</b> Why use R</a></li>
<li class="chapter" data-level="13" data-path="answers.html"><a href="answers.html"><i class="fa fa-check"></i><b>13</b> Answers</a><ul>
<li class="chapter" data-level="13.1" data-path="answers.html"><a href="answers.html#ans_createdata"><i class="fa fa-check"></i><b>13.1</b> Creating Data Answers</a><ul>
<li class="chapter" data-level="13.1.1" data-path="answers.html"><a href="answers.html#changing-mpg-data"><i class="fa fa-check"></i><b>13.1.1</b> Changing mpg data</a></li>
</ul></li>
<li class="chapter" data-level="13.2" data-path="answers.html"><a href="answers.html#ans_loadcsv"><i class="fa fa-check"></i><b>13.2</b> Loading csv data answers</a></li>
<li class="chapter" data-level="13.3" data-path="answers.html"><a href="answers.html#ans_loadexcel"><i class="fa fa-check"></i><b>13.3</b> Loading excel data answers</a></li>
<li class="chapter" data-level="13.4" data-path="answers.html"><a href="answers.html#gg_answers"><i class="fa fa-check"></i><b>13.4</b> ggplot answers</a><ul>
<li class="chapter" data-level="13.4.1" data-path="answers.html"><a href="answers.html#boxplot-of-highway-miles-per-gallon-versus-class-mpg-dataset"><i class="fa fa-check"></i><b>13.4.1</b> Boxplot of highway miles per gallon versus class (mpg dataset)</a></li>
<li class="chapter" data-level="13.4.2" data-path="answers.html"><a href="answers.html#histogram-of-city-miles-per-gallon-faceted-by-transmission-type-mpg-dataset"><i class="fa fa-check"></i><b>13.4.2</b> Histogram of city miles per gallon faceted by transmission type (mpg dataset)</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="answers.html"><a href="answers.html#stats_proofvariance"><i class="fa fa-check"></i><b>13.5</b> Proof of variance</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="acks.html"><a href="acks.html"><i class="fa fa-check"></i><b>14</b> Acknowledgements</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R @ R(D)SVS</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidyverse" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> The Tidyverse</h1>
<div class="los">
<p>
You can skip this chapter if:
</p>
<ul>
<li>
<p>
You are comfortable using the tidyverse <code>pivot_longer</code> and <code>pivot_wider</code> commands
</p>
</li>
<li>
<p>
You can rename variables
</p>
</li>
<li>
<p>
You can create and change variables in a dataset.
</p>
</li>
</ul>
</div>
<div id="tidy_opinions" class="section level2">
<h2><span class="header-section-number">7.1</span> Opinionated Packages</h2>
<p>Throughout this book I’ve been teaching you the <code>tidyverse</code> way of doing things. There’s quite a lot of debate as to whether <code>tidyverse</code> is the easy or hard way to learn things. A lot of people think that <code>tidyverse</code> is more difficult because it sometimes generates more lines of code. However, I really like the way that <code>tidyverse</code> code is easily guessed. If you know you want to change something, you can take a guess at what <a href="https://dplyr.tidyverse.org/">verb</a> you want to use.</p>
<p>This is because the <code>tidyverse</code> is ‘opinionated’. That means there’s an underlying philosophy behind how each package tries to think about data. I like the underlying theory, and I also like that the packages are explicit about the fact that data science itself comes with its own philosophies.</p>
<p>One of the most important philosophies, as <a href="http://vita.had.co.nz/papers/tidy-data.html">everyone online says</a> - tidy data has <strong>one observation per row</strong>.</p>
<p>There are a few things that <code>tidyverse</code> makes really easy:</p>
<ul>
<li><p>Visualising data with <a href="ggplot.html#gg_build">ggplot2</a></p></li>
<li><p>Making new variables or changing variables with <code>mutate</code></p></li>
<li><p>‘Pivoting’ data into tall and wide formats with <code>pivot</code></p></li>
</ul>
<p>We will cover these commands in this chapter.</p>
</div>
<div id="data-for-this-chapter" class="section level2">
<h2><span class="header-section-number">7.2</span> Data for this chapter</h2>
<p>For this chapter let’s work on an example of student satisfaction data. We’ll use a short, fictional example to avoid embarrassing anyone. Let’s say I questioned my students on two courses, Professional Skills, an undergraduate course, and Research Methods, a postgraduate course. I know how many students (<code>n</code>) were in each class, and I asked each class if they agreed with two statements, “Jill was a good teacher” (<code>good_teacher</code>) and “I learned in this class” (<code>learned</code>). I know what percentage of students disagreed with the statement (<code>disagree</code>), were neutral about the statement (<code>neutral</code>), or agreed with the statement (<code>agree</code>). And I also know which of the two years I asked the question in (<code>year</code>).</p>
<p>Let’s load the data and the tidyverse package first:</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb80-2" title="2"></a>
<a class="sourceLine" id="cb80-3" title="3">students &lt;-<span class="st"> </span><span class="kw">tibble</span> (<span class="dt">course =</span> <span class="kw">c</span>(<span class="st">&quot;Prof Skills&quot;</span>, <span class="st">&quot;Prof Skills&quot;</span>, <span class="st">&quot;Prof Skills&quot;</span>, <span class="st">&quot;Prof Skills&quot;</span>, </a>
<a class="sourceLine" id="cb80-4" title="4">                               <span class="st">&quot;Research Methods&quot;</span>, <span class="st">&quot;Research Methods&quot;</span>, <span class="st">&quot;Research Methods&quot;</span>, <span class="st">&quot;Research Methods&quot;</span>),</a>
<a class="sourceLine" id="cb80-5" title="5">                    <span class="dt">level =</span> <span class="kw">c</span>(<span class="st">&quot;UG&quot;</span>, <span class="st">&quot;UG&quot;</span>, <span class="st">&quot;UG&quot;</span>, <span class="st">&quot;UG&quot;</span>,</a>
<a class="sourceLine" id="cb80-6" title="6">                              <span class="st">&quot;PG&quot;</span>, <span class="st">&quot;PG&quot;</span>, <span class="st">&quot;PG&quot;</span>, <span class="st">&quot;PG&quot;</span>),</a>
<a class="sourceLine" id="cb80-7" title="7">                    <span class="dt">question =</span> <span class="kw">c</span>(<span class="st">&quot;good_teacher&quot;</span>, <span class="st">&quot;learned&quot;</span>,<span class="st">&quot;good_teacher&quot;</span>, <span class="st">&quot;learned&quot;</span>,</a>
<a class="sourceLine" id="cb80-8" title="8">                                 <span class="st">&quot;good_teacher&quot;</span>, <span class="st">&quot;learned&quot;</span>,<span class="st">&quot;good_teacher&quot;</span>, <span class="st">&quot;learned&quot;</span>),</a>
<a class="sourceLine" id="cb80-9" title="9">                    <span class="dt">year =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>,</a>
<a class="sourceLine" id="cb80-10" title="10">                             <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>),</a>
<a class="sourceLine" id="cb80-11" title="11">                    <span class="dt">disagree =</span> <span class="kw">c</span>(<span class="fl">0.8</span>, <span class="fl">0.3</span>, <span class="fl">0.8</span>, <span class="fl">0.2</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>, <span class="fl">0.6</span>, <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb80-12" title="12">                    <span class="dt">neutral =</span> <span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.2</span>, <span class="fl">0.3</span>),</a>
<a class="sourceLine" id="cb80-13" title="13">                    <span class="dt">agree =</span> <span class="kw">c</span>(<span class="fl">0.15</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>),</a>
<a class="sourceLine" id="cb80-14" title="14">                    <span class="dt">n =</span> <span class="kw">c</span>(<span class="dv">121</span>, <span class="dv">121</span>, <span class="dv">140</span>, <span class="dv">140</span>, <span class="dv">50</span>, <span class="dv">50</span>, <span class="dv">57</span>,<span class="dv">57</span>))  </a></code></pre></div>
</div>
<div id="mutate" class="section level2">
<h2><span class="header-section-number">7.3</span> Mutating data</h2>
<p>We have covered the <code>mutate</code> function in previous chapters, but I’m going to specifically cover a few different forms of it now.</p>
<p>In this section I’m going to create a new dataset <code>students_tidy</code> which will leave our original dataset <code>students</code> untouched. This is to demonstrate how much data can be transformed, and you might want to think about the difference between the original dataset and the finished product when you’re thinking about <a href="dataprocessing.html#workflows">workflows</a>.</p>
<div id="mutate-to-change-a-variable-type." class="section level3">
<h3><span class="header-section-number">7.3.1</span> Mutate to change a variable type.</h3>
<p>Let’s start with an example you’ve seen before. At the moment, <code>year</code> is a numerical variable, which we can prove:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="kw">is.numeric</span>(students<span class="op">$</span>year)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>So the first thing we want to do is make year a categorical variable, since there’s only two years available to us. We can retain the order of the levels by specifying them with the <code>parse_factor</code> command. <code>parse_factor</code> is really useful, but it only works on character variables, so we need to first change year to a character, and then to a factor.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">students_tidy &lt;-<span class="st"> </span>students <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb83-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">year =</span> <span class="kw">as.character</span>(year),</a>
<a class="sourceLine" id="cb83-3" title="3">         <span class="dt">year =</span> <span class="kw">parse_factor</span>(year, <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;1&quot;</span>, <span class="st">&quot;2&quot;</span>)))</a></code></pre></div>
<p>You can try taking out the <code>year = as.character(year)</code> line to see what happens. What error messages do you get?</p>
<p>And now we can ask:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">is.factor</span>(students<span class="op">$</span>year)</a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">is.factor</span>(students_tidy<span class="op">$</span>year)</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="mutate-to-change-the-contents-of-data" class="section level3">
<h3><span class="header-section-number">7.3.2</span> Mutate to change the contents of data</h3>
<p>What if we don’t want to change data type, but instead change the text of the data? There’s a very cool function called <code>case_when</code> which works like an if statement in Excel.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">students_tidy &lt;-<span class="st"> </span>students_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb88-2" title="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">level =</span> <span class="kw">case_when</span>(level <span class="op">==</span><span class="st"> &quot;UG&quot;</span> <span class="op">~</span><span class="st"> &quot;Undergraduate&quot;</span>,</a>
<a class="sourceLine" id="cb88-3" title="3">                           level <span class="op">==</span><span class="st"> &quot;PG&quot;</span> <span class="op">~</span><span class="st"> &quot;Postgraduate&quot;</span>))</a></code></pre></div>
<div class="translate">
<p>
In this code chunk we:
</p>
<ol style="list-style-type: decimal">
<li>
Create the object <code>students_tidy</code> (which we are overwriting, since it already exists)
</li>
<li>
Make the new <code>students_tidy</code> object from the old one, and then …
</li>
<li>
Change a variable within <code>students_tidy</code> (<code>mutate</code>)
</li>
<li>
Create a new variable <code>level</code> (which we are overwriting, since it already exists)
</li>
<li>
When a row of <code>level</code> reads <code>UG</code>, change it to (<code>~</code>) <code>Undergraduate</code>
</li>
<li>
When a row of <code>level</code> reads <code>PG</code>, change it to (<code>~</code>) <code>Postgraduate</code>
</li>
</ol>
</div>
<p>And we can check to see if this work by looking at a slice of the data.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">head</span>(students_tidy)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   course           level         question     year  disagree neutral agree     n
##   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;        &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Prof Skills      Undergraduate good_teacher 1           80       5    15   121
## 2 Prof Skills      Undergraduate learned      1           30      40    30   121
## 3 Prof Skills      Undergraduate good_teacher 2           80      10    10   140
## 4 Prof Skills      Undergraduate learned      2           20      30    50   140
## 5 Research Methods Postgraduate  good_teacher 1           70      10    20    50
## 6 Research Methods Postgraduate  learned      1           50      40    10    50</code></pre>
</div>
<div id="mutate-to-change-multiple-variables" class="section level3">
<h3><span class="header-section-number">7.3.3</span> Mutate to change multiple variables</h3>
<p>We can also change multiple variables using the <code>mutate_at</code> function. This can be a little more difficult to master, but is often faster than typing out multiple lines of <code>mutate</code>.</p>
<p>Our <code>disagree</code>, <code>neutral</code> and <code>agree</code> columns are currently expressed as percentages, e.g. row 1 above had 80% of students disagreing, 5% of students neutral, and 15% of students agreeing with the statement I was a good teacher. However, we know the number of students in each class, so it might be better to express those values as a proportion (e.g. 0.8, 0.05, 0.15). That’s a simple calculation - we need to take each value and divide by 100.</p>
<p>To do this, we need to use two particularly cool things about <code>tidyverse</code>, the ability to select multiple variables, and the ability to use <code>.</code> to mean <code>whatever I just asked for</code>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1">students_tidy &lt;-<span class="st"> </span>students_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="st">  </span><span class="kw">mutate_at</span>(<span class="dt">.vars =</span> <span class="kw">vars</span>(<span class="kw">c</span>(disagree, neutral, agree)),</a>
<a class="sourceLine" id="cb91-3" title="3">            <span class="dt">.funs =</span> <span class="op">~</span>(.  <span class="op">/</span><span class="st"> </span><span class="dv">100</span>))</a></code></pre></div>
<div class="translate">
<p>
In this code chunk we:
</p>
<ol style="list-style-type: decimal">
<li>
Create the object <code>students_tidy</code> (which we are overwriting, since it already exists)
</li>
<li>
Make the new <code>students_tidy</code> object from the old one, and then …
</li>
<li>
Change more than one variable within <code>students_tidy</code> (<code>mutate</code>)
</li>
<li>
Specify what variables we want to change (<code>.vars = vars</code>)
</li>
<li>
List those variables, which are a string of names (<code>c(disagree, neutral, agree)</code>)
</li>
<li>
Specify the function we want to apply to each of the previously selected variables (<code>.funs =</code>)
</li>
<li>
We’re not asking for a named function so we show this with <code>~</code>
</li>
<li>
We want to divide the previously asked for variables by 100 (<code>(./100)</code>, where <code>.</code> is a dummy variable standing in for the previously selected variables. )
</li>
</ol>
</div>
<p>And as always, we can test this by showing a slice of the data:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">head</span>(students_tidy)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   course           level         question     year  disagree neutral agree     n
##   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;        &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Prof Skills      Undergraduate good_teacher 1          0.8    0.05  0.15   121
## 2 Prof Skills      Undergraduate learned      1          0.3    0.4   0.3    121
## 3 Prof Skills      Undergraduate good_teacher 2          0.8    0.1   0.1    140
## 4 Prof Skills      Undergraduate learned      2          0.2    0.3   0.5    140
## 5 Research Methods Postgraduate  good_teacher 1          0.7    0.1   0.2     50
## 6 Research Methods Postgraduate  learned      1          0.5    0.4   0.1     50</code></pre>
</div>
<div id="tidy_summ" class="section level3">
<h3><span class="header-section-number">7.3.4</span> Summarise as a unique form of mutate</h3>
<p>Mutate is really powerful thing, so unsurprisingly the idea behind it is used in other calls. One that’s really useful to know about (and that we’ll talk more about in <a href="statsbasic.html#descstats">descriptive statistics</a>) is <code>summarise</code>.</p>
<p><code>summarise</code> creates a new mutated data frame by default, so its good for grouping together things, for example we can use it to look at the average percentage in each group by question:</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">students_summed &lt;-<span class="st"> </span>students_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(question) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb94-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_disagree =</span> <span class="kw">mean</span>(disagree),</a>
<a class="sourceLine" id="cb94-4" title="4">            <span class="dt">mean_neutral=</span> <span class="kw">mean</span>(neutral),</a>
<a class="sourceLine" id="cb94-5" title="5">            <span class="dt">mean_agree =</span> <span class="kw">mean</span>(agree))</a></code></pre></div>
<p>And in fact, if we just want to look at this data quickly, we don’t even need to create a new dataset, we can just look at the output in the console:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1">students_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(question) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb95-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_disagree =</span> <span class="kw">mean</span>(disagree),</a>
<a class="sourceLine" id="cb95-4" title="4">            <span class="dt">mean_neutral=</span> <span class="kw">mean</span>(neutral),</a>
<a class="sourceLine" id="cb95-5" title="5">            <span class="dt">mean_agree =</span> <span class="kw">mean</span>(agree))</a></code></pre></div>
<pre><code>## # A tibble: 2 x 4
##   question     mean_disagree mean_neutral mean_agree
##   &lt;chr&gt;                &lt;dbl&gt;        &lt;dbl&gt;      &lt;dbl&gt;
## 1 good_teacher         0.725        0.112      0.162
## 2 learned              0.325        0.35       0.325</code></pre>
<p>You’ll note that we lose all the other variables (like <code>course</code>, <code>level</code> and <code>n</code>) doing this, so you might want to be careful if you’re using <code>summarise</code> to make a new dataset.</p>
</div>
</div>
<div id="pivoting_data" class="section level2">
<h2><span class="header-section-number">7.4</span> Wide and tall data</h2>
<div class="hey">
<p>
If you are looking at older materials they may use the terms <code>gather</code> instead of <code>pivot_longer</code> and <code>spread</code> instead of <code>pivot_wider</code>. In fact you can find a very similar version of the below text <a href="https://rawgit.com/jillymackay/RConversations/master/WideandTall.html">on my github page</a>.
</p>
<p>
This is a notable point about R - it is a language that is being actively used and changes as people use it. The idea is that <code>pivot_longer</code> is a more informative verb than <code>gather</code>, and so we should try to use that instead. At the moment both commands still work, but this may change in the years to come.
</p>
</div>
<div id="processing-data" class="section level3">
<h3><span class="header-section-number">7.4.1</span> Processing data</h3>
<p>Let’s look at <code>students_tidy</code> again.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1"><span class="kw">head</span>(students_tidy)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   course           level         question     year  disagree neutral agree     n
##   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;        &lt;fct&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Prof Skills      Undergraduate good_teacher 1          0.8    0.05  0.15   121
## 2 Prof Skills      Undergraduate learned      1          0.3    0.4   0.3    121
## 3 Prof Skills      Undergraduate good_teacher 2          0.8    0.1   0.1    140
## 4 Prof Skills      Undergraduate learned      2          0.2    0.3   0.5    140
## 5 Research Methods Postgraduate  good_teacher 1          0.7    0.1   0.2     50
## 6 Research Methods Postgraduate  learned      1          0.5    0.4   0.1     50</code></pre>
<p>At first glance, this looks tidy. The data is presented with each course on a row - surely I’m observing at the course level?</p>
<p>Well, actually, I probably often want to know what % of students agreed (or not) with each statement in each course. The observation in this case is actually the proportion of students, with question response, question, course, level, and year, all being extra pieces of information I know about the proportion.</p>
<p>I want much taller data.</p>
<p>(I’m using this specific example not because it’s a particularly easy example, but because this is a format you’ll see for data in the real world all the time, and people will make big decisions on this data. It’s a good idea to show you how to tidy it.)</p>
</div>
<div id="pivot_longer" class="section level3">
<h3><span class="header-section-number">7.4.2</span> pivot_longer</h3>
<p>The <code>pivot_longer</code> command is a quick way to smush this data into a tall (or long) format. It creates two new columns, the <code>names_to</code> column which collects your old column names and your <code>values_to</code> column which collects the row values (fairly self-explanatory).</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1">students_tall &lt;-<span class="st"> </span>students_tidy <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="st">  </span><span class="kw">pivot_longer</span>(<span class="dt">cols =</span> <span class="kw">c</span>(disagree, neutral, agree),</a>
<a class="sourceLine" id="cb99-3" title="3">               <span class="dt">names_to =</span> <span class="st">&quot;response&quot;</span>,</a>
<a class="sourceLine" id="cb99-4" title="4">               <span class="dt">values_to =</span> <span class="st">&quot;prop&quot;</span>)</a></code></pre></div>
<p>This says:</p>
<div class="translate">
<p>
In the above code block we:
</p>
<ol style="list-style-type: decimal">
<li>
Create a new dataset called <code>students_tall</code>
</li>
<li>
<code>students_tall</code> is based on <code>students_tidy</code>
</li>
<li>
We want to squish the data into new columns (<code>pivot_longer</code>)
</li>
<li>
We specify the columns we want to stretch into two (<code>cols = c(disagree, neutral, agree)</code>)
</li>
<li>
We specify the name for new column which will take the value of the old column headers (<code>names_to = “response”</code> - note we have to put quotation marks around the new name, which is not very common in <code>tidyverse</code>)
</li>
<li>
We specify the name for the new column which will store the values of the old rows (<code>values_to = “prop”</code>)
</li>
</ol>
</div>
<p>And of course, we can see what this has done to the data:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">head</span>(students_tall)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 7
##   course      level         question     year      n response  prop
##   &lt;chr&gt;       &lt;chr&gt;         &lt;chr&gt;        &lt;fct&gt; &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;
## 1 Prof Skills Undergraduate good_teacher 1       121 disagree  0.8 
## 2 Prof Skills Undergraduate good_teacher 1       121 neutral   0.05
## 3 Prof Skills Undergraduate good_teacher 1       121 agree     0.15
## 4 Prof Skills Undergraduate learned      1       121 disagree  0.3 
## 5 Prof Skills Undergraduate learned      1       121 neutral   0.4 
## 6 Prof Skills Undergraduate learned      1       121 agree     0.3</code></pre>
<div class="hey">
<p>
It’s very important to <strong>think about your variable names</strong>
</p>
<p>
I once spent a whole afternoon trying to recreate an error message I was getting with this, when I realised that I was saying <code>names_to = “question”</code>. The variable <code>question</code> already exists in the dataset, and so R was re-writing the variable every time it gathered the data. Unique variable names are really helpful!
</p>
</div>
</div>
</div>
<div id="pivot_wider" class="section level2">
<h2><span class="header-section-number">7.5</span> pivot_wider</h2>
<p>What if, after all that, you realise that you never wanted your data gathered at all? <code>pivot_wider</code> is here to rescue you.</p>
<p>Just as before, <code>spread</code> wants to know the <code>key</code> and the <code>value</code>, but this time, it will split those two columns into multiple columns. This time we want all that data to be spread out like marmalade on toast, so we don’t exclude any columns (in fact, try excluding the columns and see what spread says. )</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1">students_wide &lt;-<span class="st"> </span>students_tall <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> response,</a>
<a class="sourceLine" id="cb102-3" title="3">              <span class="dt">values_from =</span> prop)</a></code></pre></div>
<p>And of course we can view this:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">head</span>(students_wide)</a></code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   course           level         question     year      n disagree neutral agree
##   &lt;chr&gt;            &lt;chr&gt;         &lt;chr&gt;        &lt;fct&gt; &lt;dbl&gt;    &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
## 1 Prof Skills      Undergraduate good_teacher 1       121      0.8    0.05  0.15
## 2 Prof Skills      Undergraduate learned      1       121      0.3    0.4   0.3 
## 3 Prof Skills      Undergraduate good_teacher 2       140      0.8    0.1   0.1 
## 4 Prof Skills      Undergraduate learned      2       140      0.2    0.3   0.5 
## 5 Research Methods Postgraduate  good_teacher 1        50      0.7    0.1   0.2 
## 6 Research Methods Postgraduate  learned      1        50      0.5    0.4   0.1</code></pre>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dataprocessing.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="trouble.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"collapse": "subsection"
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
